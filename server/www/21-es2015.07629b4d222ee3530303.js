(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{rBND:function(t,e,i){"use strict";i.r(e),i.d(e,"TagFormPageModule",(function(){return k}));var s=i("ofXK"),n=i("3Pt+"),o=i("TEn/"),a=i("tyNb"),r=i("mrSG"),c=i("FMb1"),l=i("HIyf"),h=i("QYMr"),b=i("fXoL"),d=i("EQut"),u=i("lBcp"),f=i("UcdY"),g=i("K1j1");function m(t,e){if(1&t){const t=b.Lb();b.Kb(0,"ion-item"),b.Kb(1,"ion-checkbox",7),b.Sb("ngModelChange",(function(i){return b.dc(t),e.$implicit.isCheck=i}))("ionChange",(function(){return b.dc(t),b.Ub().validateForm()})),b.Jb(),b.Kb(2,"ion-label"),b.ic(3),b.Jb(),b.Jb()}if(2&t){const t=e.$implicit;b.xb(1),b.ac("ngModel",t.isCheck),b.xb(2),b.jc(t.name)}}const v=[{path:"",component:(()=>{class t{constructor(t,e,i,s,n,o,a){this.branchService=t,this.tagService=e,this.activatedRoute=i,this.alertController=s,this.router=n,this.questionService=o,this.nlService=a,this.branchList=new Array,this.checkList=new Array,this.labels=[]}ngOnInit(){}ionViewWillEnter(){this.questionId=this.activatedRoute.snapshot.params.id,this.labels=this.activatedRoute.snapshot.queryParams.labels?this.activatedRoute.snapshot.queryParams.labels:[],this.getBranches(),this.formValid=!1,this.addWords=!1}navigateAlert(t,e,i,s){return Object(r.a)(this,void 0,void 0,(function*(){const n=yield this.alertController.create({header:t,subHeader:e,buttons:[{text:i,handler:()=>{this.router.navigate(["/"+s+"/"])}}]});yield n.present()}))}getBranches(){this.branchService.getBranches().subscribe(t=>{t.status?(this.branchList=t.data,this.fillList()):this.navigateAlert("\xa1ERROR AL OBTENER INFORMACION","Hubo un problema al intentar obtener informacion del servidor","OK","my-questions")},t=>{this.navigateAlert("ERROR DE SERVIDOR",t.message,"OK","my-questions")})}fillList(){for(const t of this.branchList){const e=new l.a;e.id=t._id,e.name=t.name,e.isCheck=!1,this.checkList.push(e)}this.fillCheckList()}fillCheckList(){let t;this.addWords=!(this.labels.length>0);for(let e of this.labels)t=this.checkList.findIndex(t=>t.id===e),this.checkList[t].isCheck=!0;this.validateForm()}createTag(){const t=new h.a;t.question._id=this.questionId;for(const e of this.checkList)if(e.isCheck){const i=new c.a;i._id=e.id,t.tags.push(i)}this.addWords&&this.addNewWords(this.checkList),this.tagService.createTag(t).subscribe(t=>{t.status?this.navigateAlert("\xa1PREGUNTA ENVIADA!","Creaste una nueva pregunta","OK","my-questions"):this.navigateAlert("\xa1ERROR AL AGREGAR LOS TAGS!","Hubo un problema al intentar crear este tag","OK","my-questions")},t=>{this.navigateAlert("ERROR DE SERVIDOR",t.message,"OK","my-questions")})}addNewWords(t){const e=new Array;for(const i of this.checkList){const t=this.labels.findIndex(t=>t===i.id);i.isCheck&&-1===t&&e.push(i.name)}this.questionService.getQuestionById(this.questionId).subscribe(t=>{t.status&&this.nlService.addNewWords(t.data.title,e).subscribe(t=>{},t=>{console.log(t)})},t=>{console.log(t)})}validateForm(){for(const t of this.checkList){const e=this.labels.findIndex(e=>e===t.id);if(t.isCheck&&-1===e){this.addWords=!0;break}this.addWords=!1}for(const t of this.checkList)if(t.isCheck)return void(this.formValid=!0);this.formValid=!1,this.addWords=!1}}return t.\u0275fac=function(e){return new(e||t)(b.Hb(d.a),b.Hb(u.a),b.Hb(a.a),b.Hb(o.b),b.Hb(a.g),b.Hb(f.a),b.Hb(g.a))},t.\u0275cmp=b.Bb({type:t,selectors:[["app-tag-form"]],decls:15,vars:2,consts:[["slot","start"],["menu","main-menu"],["lines","full"],["color","medium"],[1,"ion-text-center"],[4,"ngFor","ngForOf"],["expand","full","color","myPrimary",3,"disabled","click"],["slot","start","color","success",3,"ngModel","ngModelChange","ionChange"]],template:function(t,e){1&t&&(b.Kb(0,"ion-header"),b.Kb(1,"ion-toolbar"),b.Kb(2,"ion-title"),b.ic(3,"Agregar etiquetas "),b.Jb(),b.Kb(4,"ion-buttons",0),b.Ib(5,"ion-menu-button",1),b.Jb(),b.Jb(),b.Jb(),b.Kb(6,"ion-content"),b.Kb(7,"ion-item",2),b.Kb(8,"ion-text",3),b.Kb(9,"div",4),b.ic(10," Por favor marca la(s) categoria(s) a la que pertenece tu pregunta. "),b.Jb(),b.Jb(),b.Jb(),b.Kb(11,"ion-list"),b.gc(12,m,4,2,"ion-item",5),b.Jb(),b.Kb(13,"ion-button",6),b.Sb("click",(function(){return e.createTag()})),b.ic(14,"Enviar"),b.Jb(),b.Jb()),2&t&&(b.xb(12),b.ac("ngForOf",e.checkList),b.xb(1),b.ac("disabled",!e.formValid))},directives:[o.w,o.R,o.Q,o.i,o.D,o.q,o.z,o.N,o.B,s.i,o.h,o.n,o.c,n.e,n.h,o.A],styles:["ion-content[_ngcontent-%COMP%]{--background:#fff}ion-title[_ngcontent-%COMP%]{--color:#fff;font-family:Arial,Helvetica,sans-serif}ion-toolbar[_ngcontent-%COMP%]{--background:#00796b;--color:#fff}ion-item[_ngcontent-%COMP%]{--background:#f5f5f5;--color:#000}"]}),t})()}];let p=(()=>{class t{}return t.\u0275mod=b.Fb({type:t}),t.\u0275inj=b.Eb({factory:function(e){return new(e||t)},imports:[[a.j.forChild(v)],a.j]}),t})(),k=(()=>{class t{}return t.\u0275mod=b.Fb({type:t}),t.\u0275inj=b.Eb({factory:function(e){return new(e||t)},imports:[[s.b,n.a,o.S,p]]}),t})()}}]);