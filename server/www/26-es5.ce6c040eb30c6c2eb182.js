!function(){function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{AbRp:function(n,r,i){"use strict";i.r(r),i.d(r,"UsersPageModule",(function(){return g}));var s=i("ofXK"),o=i("3Pt+"),c=i("TEn/"),a=i("tyNb"),u=i("mrSG"),l=i("fXoL"),b=i("qfBg");function f(e,t){if(1&e){var n=l.Lb();l.Kb(0,"ion-item"),l.Kb(1,"ion-thumbnail",8),l.Kb(2,"ion-button",9),l.Sb("click",(function(){l.dc(n);var e=t.$implicit;return l.Ub().confirmDelete(e._id)})),l.Ib(3,"ion-icon",10),l.Jb(),l.Kb(4,"ion-button",11),l.Sb("click",(function(){l.dc(n);var e=t.$implicit;return l.Ub().presentActionSheet(e._id)})),l.Ib(5,"ion-icon",12),l.Jb(),l.Jb(),l.Kb(6,"ion-label",13),l.Kb(7,"strong"),l.ic(8),l.Jb(),l.Kb(9,"ion-text",14),l.Kb(10,"strong",15),l.ic(11,"Rol: "),l.Jb(),l.ic(12),l.Jb(),l.Kb(13,"ion-text",14),l.Kb(14,"strong",15),l.ic(15,"C\xf3digo: "),l.Jb(),l.ic(16),l.Jb(),l.Kb(17,"ion-text",14),l.Kb(18,"strong",15),l.ic(19,"Email: "),l.Jb(),l.ic(20),l.Jb(),l.Jb(),l.Jb()}if(2&e){var r=t.$implicit;l.xb(8),l.jc(r.name+" "+r.lastName),l.xb(4),l.kc(" ",0==r.permission?"Usuario":"Admin",""),l.xb(4),l.kc(" ",r.code,""),l.xb(4),l.kc(" ",r.email,"")}}var d,m,h,p=[{path:"",component:(d=function(){function n(t,r,i){e(this,n),this.userService=t,this.actionSheetController=r,this.alertController=i,this.usersList=new Array}var r,i,s;return r=n,(i=[{key:"ngOnInit",value:function(){}},{key:"ionViewWillEnter",value:function(){this.getUsers()}},{key:"confirmPermission",value:function(e,t){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var r,i=this;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.alertController.create({cssClass:"my-custom-class",header:"\xa1CONFIRMAR!",message:"\xbfEstas seguro que deseas conceder el permiso de "+(0===e?" solo USUARIO":"ADMINISTRADOR")+"?",buttons:[{text:"No",role:"cancel",cssClass:"secondary"},{text:"Si",cssClass:"success",handler:function(){i.changePermission(e,t)}}]});case 2:return r=n.sent,n.next=5,r.present();case 5:case"end":return n.stop()}}),n,this)})))}},{key:"confirmDelete",value:function(e){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.alertController.create({cssClass:"my-custom-class",header:"\xa1CONFIRMAR!",message:"\xbfEstas seguro que deseas eliminar este usuario?",buttons:[{text:"No",role:"cancel",cssClass:"secondary"},{text:"Si",role:"danger",handler:function(){r.deleteUser(e)}}]});case 2:return n=t.sent,t.next=5,n.present();case 5:case"end":return t.stop()}}),t,this)})))}},{key:"presentActionSheet",value:function(e){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.actionSheetController.create({header:"Permisos",mode:"ios",buttons:[{text:"Administrador",icon:"",handler:function(){r.confirmPermission(1,e)}},{text:"Usuario",icon:"",handler:function(){r.confirmPermission(0,e)}}]});case 2:return n=t.sent,t.next=5,n.present();case 5:case"end":return t.stop()}}),t,this)})))}},{key:"getUsers",value:function(){var e=this;this.userService.getUsers().subscribe((function(t){e.usersList=t.data}),(function(e){console.log(e)}))}},{key:"getReloadUsers",value:function(e){var t=this;this.userService.getUsers().subscribe((function(n){t.usersList=n.data,e.target.complete()}),(function(t){console.log(t),e.target.complete()}))}},{key:"changePermission",value:function(e,t){var n=this;this.userService.updatePermission(e,t).subscribe((function(t){if(t.status){var r=n.usersList.findIndex((function(e){return e._id===t.data._id}));n.usersList[r].permission=e}}),(function(e){console.log(e)}))}},{key:"deleteUser",value:function(e){var t=this;this.userService.deleteUser(e).subscribe((function(e){if(e.status){var n=t.usersList.findIndex((function(t){return t._id===e.data._id}));t.usersList.splice(n,1)}}),(function(e){}))}}])&&t(r.prototype,i),s&&t(r,s),n}(),d.\u0275fac=function(e){return new(e||d)(l.Hb(b.a),l.Hb(c.a),l.Hb(c.b))},d.\u0275cmp=l.Bb({type:d,selectors:[["app-users"]],decls:13,vars:1,consts:[["color","headerColor"],["slot","start"],["menu","main-menu"],["slot","end"],["defaultHref","events"],[1,"ios"],["slot","fixed",3,"ionRefresh"],[4,"ngFor","ngForOf"],["slot","end",1,"ion-text-wrap","ion-text-right"],["color","danger",3,"click"],["name","trash"],["color","secondary",3,"click"],["name","lock-open"],[1,"ion-text-wrap"],["color","primary",2,"display","block"],[2,"color","rgb(124, 124, 124)"]],template:function(e,t){1&e&&(l.Kb(0,"ion-header"),l.Kb(1,"ion-toolbar",0),l.Kb(2,"ion-title"),l.ic(3,"Usuarios (Admin) "),l.Jb(),l.Kb(4,"ion-buttons",1),l.Ib(5,"ion-menu-button",2),l.Jb(),l.Kb(6,"ion-buttons",3),l.Ib(7,"ion-back-button",4),l.Jb(),l.Jb(),l.Jb(),l.Kb(8,"ion-content",5),l.Kb(9,"ion-refresher",6),l.Sb("ionRefresh",(function(e){return t.getReloadUsers(e)})),l.Ib(10,"ion-refresher-content"),l.Jb(),l.Kb(11,"ion-list"),l.gc(12,f,21,4,"ion-item",7),l.Jb(),l.Jb()),2&e&&(l.xb(12),l.ac("ngForOf",t.usersList))},directives:[c.w,c.R,c.Q,c.i,c.D,c.f,c.g,c.q,c.F,c.G,c.B,s.i,c.z,c.P,c.h,c.x,c.A,c.N],styles:[""]}),d)}],v=((h=function t(){e(this,t)}).\u0275mod=l.Fb({type:h}),h.\u0275inj=l.Eb({factory:function(e){return new(e||h)},imports:[[a.i.forChild(p)],a.i]}),h),g=((m=function t(){e(this,t)}).\u0275mod=l.Fb({type:m}),m.\u0275inj=l.Eb({factory:function(e){return new(e||m)},imports:[[s.b,o.a,c.S,v]]}),m)}}])}();